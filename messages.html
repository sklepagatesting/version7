<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Messenger</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body class="h-screen bg-gray-100 flex flex-col">

  <!-- Chat wrapper -->
  <div class="flex flex-col flex-1 max-w-4xl w-full mx-auto bg-white shadow-lg">

    <!-- Messages -->
    <div id="messagesContainer" class="flex-1 min-h-0 overflow-y-auto p-4 space-y-3">
      <!-- Messages injected here -->
    </div>

    <!-- Chat input -->
    <div class="chat-input-wrapper flex-shrink-0 border-t border-gray-200 bg-white p-3 flex items-end gap-2">
      <textarea id="replyInput" rows="1" class="flex-1 resize-none border border-gray-300 rounded-lg p-2 focus:outline-none focus:border-blue-500" placeholder="Type a message..."></textarea>
      <button id="sendButton" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">Send</button>
    </div>
  </div>

  <script>
    // Your Firebase config from your original file
    const firebaseConfig = {
      apiKey: "AIzaSyBEdQd16opvVRwIaxFOHZzgwMX_i32tuP8",
      authDomain: "messenger-83e9b.firebaseapp.com",
      projectId: "messenger-83e9b",
      storageBucket: "messenger-83e9b.appspot.com",
      messagingSenderId: "215762388926",
      appId: "1:215762388926:web:fe7950eddb6d62141bb8b3"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const messagesContainer = document.getElementById('messagesContainer');
    const replyInput = document.getElementById('replyInput');
    const sendButton = document.getElementById('sendButton');

    // Auto-resize textarea
    replyInput.addEventListener('input', () => {
      replyInput.style.height = 'auto';
      replyInput.style.height = replyInput.scrollHeight + 'px';
    });

    // Load messages
    db.collection("messages").orderBy("time", "asc").onSnapshot(snapshot => {
      messagesContainer.innerHTML = '';
      snapshot.forEach(doc => {
        const msg = doc.data();
        const msgDiv = document.createElement('div');
        msgDiv.className = "bg-gray-100 p-2 rounded-lg";
        msgDiv.innerHTML = `
          <div>${msg.message}</div>
          <div class="text-xs text-gray-500">${msg.time}</div>
        `;
        messagesContainer.appendChild(msgDiv);
      });
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    });

    // Send message
    sendButton.addEventListener('click', () => {
      const text = replyInput.value.trim();
      if (text) {
        db.collection("messages").add({
          message: text,
          time: new Date().toLocaleTimeString()
        });
        replyInput.value = '';
        replyInput.style.height = 'auto';
      }
    });
  </script>
</body>
</html>
